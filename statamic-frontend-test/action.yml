name: "Statamic Frontend Test"
description: "Install, lint, audit and build frontend"

inputs:
  node-version:
    description: "Node.js version"
    required: false
    default: "20"

  working-directory:
    description: "Directory where package.json is located"
    required: false
    default: "."

runs:
  using: "composite"
  steps:

    - name: ğŸ§¾ Checkout Code
      uses: actions/checkout@v6

    - name: ğŸŸ¢ Setup Node
      uses: actions/setup-node@v6
      with:
        node-version: ${{ inputs.node-version }}

    - name: ğŸ“¦ Install frontend dependencies
      run: npm ci --no-audit --no-fund --prefer-offline
      shell: bash
      working-directory: ${{ inputs.working-directory }}

    - name: ğŸ” Lint
      run: npm run lint
      shell: bash
      working-directory: ${{ inputs.working-directory }}

    - name: ğŸ” Security audit
      run: npm audit signatures
      shell: bash
      working-directory: ${{ inputs.working-directory }}

    - name: ğŸ— Build
      run: npm run build
      shell: bash
      working-directory: ${{ inputs.working-directory }}